# Some settings from https://pastebin.com/S8m1jnY3
{ config, pkgs, ... }:

{
  programs.autorandr = {
    enable = true;
    profiles = {
      baarch = {
        fingerprint = {
        DP-1-2 = "00ffffffffffff0030aee96100000000101f0104a53c22783e6665a9544c9d26105054a1080081c0810081809500a9c0b300d1c00101565e00a0a0a0295030203500615d2100001a000000fc00503237682d32300a2020202020000000fd00324c1e5a24000a202020202020000000ff0056393037545747300a202020200152020318f14b9005040302011f13140e0f23090f0783010000662156aa51001e30468f33000f282100001eab22a0a050841a30302036000f282100001c7c2e90a0601a1e40302036000f282100001c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a";
        DP-1-4 = "00ffffffffffff0030aee96100000000191e0104a53c22783e6665a9544c9d26105054a1080081c0810081809500a9c0b300d1c00101565e00a0a0a0295030203500615d2100001a000000fc00503237682d32300a2020202020000000fd00324c1e5a24000a202020202020000000ff0056393036394246450affffffff01eb020318f14b9005040302011f13140e0f23090f0783010000662156aa51001e30468f33000f282100001eab22a0a050841a30302036000f282100001c7c2e90a0601a1e40302036000f282100001c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a";
        eDP-1 = "00ffffffffffff0009e5de0800000000011d0104b5261578030e18a75333bb200f535e0000000101010101010101010101010101010152d000a0f0703e80302035007ed71000001a00000000000000000000000000000000001a000000fe00424f452048460a202020202020000000fe004e4531373351554d2d4e34320a015102030f00e3058000e60605016a6a24000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009a";
        };
        config = {
          DP-1-4 = {
            crtc = 4;
            filter = "bilinear";
            mode = "2560x1440";
            position = "6400x0";
            rate = "59.95";
            transform = [
              [ 1.299988 0.000000 0.000000 ]
              [ 0.000000 1.299988 0.000000 ]
              [ 0.000000 0.000000 1.000000 ]
            ];
          };

          DP-1-2 = {
            crtc = 5;
            filter = "bilinear";
            mode = "2560x1440";
            position = "3072x0";
            rate = "59.95";
            transform = [
              [ 1.299988 0.000000 0.000000 ]
              [ 0.000000 1.299988 0.000000 ]
              [ 0.000000 0.000000 1.000000 ]
            ];
          };


          eDP-1 = {
            crtc = 0;
            filter = "bilinear";
            mode = "3840x2160";
            position = "0x0";
            rate = "60.00";
            transform = [
              [ 0.799988 0.000000 0.000000 ]
              [ 0.000000 0.799988 0.000000 ]
              [ 0.000000 0.000000 1.000000 ]
            ];
          };

        };
      };
    };
    hooks = {
      postswitch = {
        notify-i3 = "${pkgs.i3}/bin/i3-msg restart";
        #change-background = "${pkgs.variety}/bin/variety --next";
        change-dpi = ''
          case "$(hostname)" in
            default)
              DPI=96
              ;;
            adama)
              DPI=144
              ;;
            galactica)
              DPI=138
              ;;
            *)
              echo "Unknown profile for host: $(hostname)"
              exit 1
          esac

          echo "Xft.dpi: $DPI" | xrdb -merge
        '';
      };
    };
  };

  services.autorandr.enable = true;
}
